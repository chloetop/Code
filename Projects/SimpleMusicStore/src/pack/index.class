package pack;

/*
 * To change this template, choose Tools | Templates and open the template in
 * the editor.
 */
import Classes.*;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.HashSet;
import java.util.Set;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

/**
 *
 * @author Administrator
 */
public class index extends HttpServlet {

    /**
     * Processes requests for both HTTP
     * <code>GET</code> and
     * <code>POST</code> methods.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    protected void processRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
//        response.setContentType("text/html;charset=UTF-8");
//        PrintWriter out = response.getWriter();
//        try {
//            /*
//             * TODO output your page here. You may use following sample code.
//             */
//            out.println("<html>");
//            out.println("<head>");
//            out.println("<title>Servlet index</title>");            
//            out.println("</head>");
//            out.println("<body>");
//            out.println("<h1>Servlet index at " + request.getContextPath() + "</h1>");
//            out.println("</body>");
//            out.println("</html>");
//        } finally {            
//            out.close();
//        }
    }

    // <editor-fold defaultstate="collapsed" desc="HttpServlet methods. Click on the + sign on the left to edit the code.">
    /**
     * Handles the HTTP
     * <code>GET</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        //    processRequest(request, response);
    }

    /**
     * Handles the HTTP
     * <code>POST</code> method.
     *
     * @param request servlet request
     * @param response servlet response
     * @throws ServletException if a servlet-specific error occurs
     * @throws IOException if an I/O error occurs
     */
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
//        RequestDispatcher dispatcher = request.getRequestDispatcher("SearchPage.jsp"); 
//        dispatcher .forward(request, response); 

        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();
        //script
        out.println("<html>");
        out.println("<head>");
        out.println("<script language=\"javascript\"> ");
        out.println(" function check(id)");
        out.println("   { var str = \"\"");
        out.println("       if(document.getElementById(id).checked ==true) {");
        out.println("           document.getElementById(\"ids\").value=document.getElementById(\"ids\").value+id+\"-\"");
        out.println("       }");
        out.println("       else {");
        out.println("          var t = document.getElementById(\"ids\").value.split('-')");
        out.println("          var str3 = \"\"");
        out.println("          for(var i = 0;i<t.length-1;i++){");
        out.println("              if(t[i]==id)");
        out.println("                  continue;");
        out.println("              else");
        out.println("                 str3 = str3 + t[i]+\"-\"");
        out.println("         }");
        out.println("         document.getElementById(\"ids\").value=str3");
        out.println("     }");
        out.println("  }");


        out.println("   var XMLHttpReq;");

        out.println(" function Add(){");
        //out.println("document.getElementById(\"ids\").value=\"\"");
        out.println(" if(window.XMLHttpRequest) { //firefox");
        out.println("      XMLHttpReq = new XMLHttpRequest();");
        out.println("  }");
        out.println("  else if (window.ActiveXObject) { // IE");
        out.println("      try {");
        out.println("         XMLHttpReq = new ActiveXObject(\"Msxml2.XMLHTTP\");");
        out.println("     } catch (e) {");
        out.println("         try {");
        out.println("             XMLHttpReq = new ActiveXObject(\"Microsoft.XMLHTTP\");");
        out.println("         } catch (e) {}");
        out.println("     }");
        out.println(" }");
        out.println(" XMLHttpReq.open(\"POST\", \"Add.jsp?sType=" + request.getParameter("sType").trim() + "&val=\"+document.getElementById(\"ids\").value, true);");
        out.println(" XMLHttpReq.onreadystatechange = processResponse;");
        out.println("  XMLHttpReq.send(null);  ");
        out.println("  }");
        out.println("function processResponse() {");
        out.println("   if (XMLHttpReq.readyState == 4) { ");
        out.println("       if (XMLHttpReq.status == 200) {");
        out.println("          alert(\"success!\")");
        // out.println("alert(\"Add.jsp?sType=" + request.getParameter("sType").trim() + "&val=\"+document.getElementById(\"ids\").value)");
        out.println(" var t = document.getElementById(\"ids\").value.split('-')");
        out.println("        document.getElementById(\"ids\").value=\"\"");
        out.println("       for(var i = 0;i<t.length-1;i++){");
        out.println("            document.getElementById(t[i]).checked = false");
        out.println("}");
        out.println("      } else { ");
        out.println("          window.alert(\"somthing wrong,contact managers pleaseã€‚\");");
        out.println("     }");
        out.println(" }");
        out.println("}");


        out.println("</script>");
        out.println("</head>");
        out.println("<body>");
        try {
            /*
             * TODO output your page here. You may use following sample code.
             */
            int GetChoice = 0;
            String KeyWords = request.getParameter("Search").trim();
            String tChoice = request.getParameter("sType").trim();
            String sGenre = request.getParameter("sGenre").trim();
            String sArtist = request.getParameter("sArtist").trim();
            String sYear = request.getParameter("sYear").trim();
            String aa = request.getParameter("ids").trim();
            if (tChoice.equals("r1")) {
                GetChoice = 1;
            } else if (tChoice.equals("r2")) {
                GetChoice = 2;
            }

//            album NewAlbum = new album();
//            NewAlbum.setAlbum_id("001");
//            NewAlbum.setArtist("fool");
//            out.println(NewAlbum.getAlbum_id());
//search info
            out.println("<table style=\"width: 100%\">");
            out.println("<tr>");
            out.println("<td rowspan=\"2\" valign=\"top\" style=\"width: 25%\">");
            out.println("Searching By:");

            out.println("<form action=\"SearchPage1\" method=\"POST\">");
            out.println(" <input type=\"text\" name=\"Search\" value=\"" + KeyWords + "\" readonly  style=\"display:none\" />");
            if (GetChoice == 1) {
                out.println(" <input type=\"text\" name=\"sType\" value =\"r1\" readonly   style=\"display:none\"/>");
            } else {
                out.println(" <input type=\"text\" name=\"sType\" value =\"r2\" readonly   style=\"display:none\"/>");
            }
//            out.println(" <input type=\"text\" name=\"sGenre\"  value =\"" + sGenre + "\"   />");
            out.println("<li ><span style=\"width:60px\">Genre:</span>");
            out.println("<select name=\"sGenre\" style=\"width:60px\">");
            if ("".equals(sGenre)) {
                out.println(" <option selected=true></option>");
            } else {
                out.println(" <option ></option>");
            }
            if (sGenre.equals("Country")) {
                out.println(" <option selected=true>Country</option>");
            } else {
                out.println(" <option >Country</option>");
            }
            if (sGenre.equals("Pop")) {
                out.println(" <option selected=true>Pop</option>");
            } else {
                out.println(" <option>Pop</option>");
            }
            if (sGenre.equals("Jazz")) {
                out.println(" <option selected=true>Jazz</option>");
            } else {
                out.println(" <option>Jazz</option>");
            }
            if (sGenre.equals("Latin")) {
                out.println("  <option selected=true>Latin</option>");
            } else {
                out.println("  <option>Latin</option>");
            }
            if (sGenre.equals("Soul")) {
                out.println("  <option selected=true>Soul</option>");
            } else {
                out.println("  <option>Soul</option>");
            }
            out.println(" </select>");
            out.println("</li>");
            out.println("<li><span style=\"width:60px\">Artist:</span>");
            out.println(" <input type=\"text\" name=\"sArtist\"  value =\"" + sArtist + "\" style=\"background-color: #a9a9a9;width:60px\" onfocus=\"this.style.background='#ffffff'\" onblur=\"this.style.background='#a9a9a9'\" />");
            out.println("</li>");
            out.println("<li><span style=\"width:60px\">Year:</span>");
//            out.println(" <input type=\"text\" name=\"sYear\"   value =\"" + sYear + "\"  />");
            out.println("<select name=\"sYear\" style=\"width:60px\">");
            if ("".equals(sYear)) {
                out.println(" <option selected=true></option>");
            } else {
                out.println(" <option ></option>");
            }
            if (sYear.equals("2012")) {
                out.println(" <option selected=true>2012</option>");
            } else {
                out.println(" <option >2012</option>");
            }
            if (sYear.equals("2011")) {
                out.println(" <option selected=true>2011</option>");
            } else {
                out.println(" <option>2011</option>");
            }
            if (sYear.equals("2010")) {
                out.println(" <option selected=true>2010</option>");
            } else {
                out.println(" <option>2010</option>");
            }
            if (sYear.equals("2009")) {
                out.println("  <option selected=true>2009</option>");
            } else {
                out.println("  <option>2009</option>");
            }
            if (sYear.equals("2008")) {
                out.println("  <option selected=true>2008</option>");
            } else {
                out.println("  <option>2008</option>");
            }
            if (sYear.equals("2007")) {
                out.println("  <option selected=true>2007</option>");
            } else {
                out.println("  <option>2007</option>");
            }
            out.println(" </select>");
            out.println("</li>");

            out.println("<input type=\"submit\" value=\"Search\" style=\"border-bottom-style: none;border-top-style: none;border-left-style: none;border-right-style: none\" onmouseover=\"this.style.background='#3366ff'\"  onmouseout=\"this.style.background='#a9a9a9'\"/>");
            out.println("<input type=\"text\" name=\"ids\" id=\"ids\" style=\"display:none\"/>");

            out.println("  </form>");
            out.println("</td>");
           // out.println("</tr>");
         //   out.println("<tr align=\"center\">");
            out.println("<td align=\"center\">");
            out.println("<input type=\"submit\" value=\"Return To Last Page\" onclick=\"window.location='AFindex.jsp'\" style=\"border-bottom-style: none;border-top-style: none;border-left-style: none;border-right-style: none\" onmouseover=\"this.style.background='#3366ff'\"  onmouseout=\"this.style.background='#a9a9a9'\"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;");
            out.println("<input type=\"submit\" value=\"Add To Cart\" onclick=\"Add()\" style=\"border-bottom-style: none;border-top-style: none;border-left-style: none;border-right-style: none\" onmouseover=\"this.style.background='#3366ff'\"  onmouseout=\"this.style.background='#a9a9a9'\"/>");
            out.println("&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"Cart.jsp\" >check cart</a>");
            out.println("</td>");
            out.println("</tr>");
            out.println("<tr>");
            out.println("<td>");
            Xml_Operation Xml_Op = new Xml_Operation();

            out.println("<table border=\"1\" cellpadding=\"0\" bordercolorlight=\"#999999\" bordercolordark=\"#FFFFFF\" width=\"700px\" cellspacing=\"0\" align=\"center\">");
            //Albums
            if (GetChoice == 1 && "".equals(KeyWords)) {
                out.println("<tr align=\"center\" style=\"background-color: #a9a9a9\"><td></td><td>Album Pic</td><td style=\"width: 150px\">Title</td><td style=\"width: 80px\">Artist</td><td style=\"width: 80px\">Genre</td><td style=\"width: 80px\">Publisher</td><td style=\"width: 50px\">Year</td><td style=\"width: 50px\">Price</td></tr>");

                NodeList Nodes = Xml_Op.ReadXml("Albums.xml", "album");
                int len = Nodes.getLength();
                for (int i = 0; i < len; i++) {
                    Node nNode = Nodes.item(i);
                    album NewAlbum = new album();
                    String temp;
                    Element eElement = (Element) nNode;

                    temp = eElement.getElementsByTagName("album_id").item(0).getChildNodes().item(0).getNodeValue();
                    NewAlbum.setAlbum_id(temp);
                    temp = eElement.getElementsByTagName("Artist").item(0).getChildNodes().item(0).getNodeValue();
                    if (!"".equals(sArtist)) {
                        if (temp.indexOf(sArtist) == -1) {
                            continue;
                        }
                    }
                    NewAlbum.setArtist(temp);
                    temp = eElement.getElementsByTagName("Title").item(0).getChildNodes().item(0).getNodeValue();
                    NewAlbum.setTitle(temp);
                    temp = eElement.getElementsByTagName("Genre").item(0).getChildNodes().item(0).getNodeValue();
                    if (!"".equals(sGenre)) {
                        if (!temp.equals(sGenre)) {
                            continue;
                        }
                    }
                    NewAlbum.setGenre(temp);
                    temp = eElement.getElementsByTagName("Year").item(0).getChildNodes().item(0).getNodeValue();
                    if (!"".equals(sYear)) {
                        if (!temp.equals(sYear)) {
                            continue;
                        }
                    }
                    NewAlbum.setYear(temp);
                    temp = eElement.getElementsByTagName("Artist").item(0).getChildNodes().item(0).getNodeValue();

                    NewAlbum.setPublisher(temp);
                    temp = eElement.getElementsByTagName("Price").item(0).getChildNodes().item(0).getNodeValue();
                    NewAlbum.setPrice(temp);
                    temp = eElement.getElementsByTagName("Description").item(0).getChildNodes().item(0).getNodeValue();
                    NewAlbum.setDescription(temp);

                    if (i % 2 == 1) {
                        out.println("<tr align=\"center\" style=\"background-color: #99ccff\">");
                    } else {
                        out.println("<tr align=\"center\" style=\"background-color: #ccccff\">");
                    }
                    out.println("<td>");
                    out.println("<input type=\"checkbox\" id=\"" + NewAlbum.getAlbum_id() + "\" name=\"" + NewAlbum.getAlbum_id() + "\" value=\"" + NewAlbum.getAlbum_id() + "\" onclick=\"check('" + NewAlbum.getAlbum_id() + "')\"/>");
                    out.println("</td>");
                    out.println("<td><img src=\"" + NewAlbum.getAlbum_id() + ".jpg\" width=\"120\" height=\"120\"/></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getTitle() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getArtist() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getGenre() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getPublisher() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getYear() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getPrice() + "</a></td>");
                    out.println("</tr>");
                }
            }
            if (GetChoice == 1 && !"".equals(KeyWords)) {
                NodeList Nodes = Xml_Op.ReadXml("Albums.xml", "album");
                out.println("<tr align=\"center\" style=\"background-color: #a9a9a9\"><td></td><td>Album Pic</td><td style=\"width: 150px\">Title</td><td style=\"width: 80px\">Artist</td><td style=\"width: 80px\">Genre</td><td style=\"width: 80px\">Publisher</td><td style=\"width: 50px\">Year</td><td style=\"width: 50px\">Price</td></tr>");
                int len = Nodes.getLength();
                for (int i = 0; i < len; i++) {
                    Node nNode = Nodes.item(i);
                    album NewAlbum = new album();
                    String temp;
                    Element eElement = (Element) nNode;
                    temp = eElement.getElementsByTagName("Title").item(0).getChildNodes().item(0).getNodeValue();
                    if (temp.indexOf(KeyWords) != -1) {
                        NewAlbum.setTitle(temp);
                        temp = eElement.getElementsByTagName("album_id").item(0).getChildNodes().item(0).getNodeValue();
                        NewAlbum.setAlbum_id(temp);
                        temp = eElement.getElementsByTagName("Artist").item(0).getChildNodes().item(0).getNodeValue();
                        if (!"".equals(sArtist)) {
                            if (temp.indexOf(sArtist) == -1) {
                                continue;
                            }
                        }
                        NewAlbum.setArtist(temp);

                        temp = eElement.getElementsByTagName("Genre").item(0).getChildNodes().item(0).getNodeValue();
                        if (!"".equals(sGenre)) {
                            if (!temp.equals(sGenre)) {
                                continue;
                            }
                        }
                        NewAlbum.setGenre(temp);
                        temp = eElement.getElementsByTagName("Year").item(0).getChildNodes().item(0).getNodeValue();
                        if (!"".equals(sYear)) {
                            if (!temp.equals(sYear)) {
                                continue;
                            }
                        }
                        NewAlbum.setYear(temp);
                        temp = eElement.getElementsByTagName("Publisher").item(0).getChildNodes().item(0).getNodeValue();

                        NewAlbum.setPublisher(temp);
                        temp = eElement.getElementsByTagName("Price").item(0).getChildNodes().item(0).getNodeValue();
                        NewAlbum.setPrice(temp);
                        temp = eElement.getElementsByTagName("Description").item(0).getChildNodes().item(0).getNodeValue();
                        NewAlbum.setDescription(temp);
                        if (i % 2 == 1) {
                            out.println("<tr align=\"center\" style=\"background-color: #99ccff\">");
                        } else {
                            out.println("<tr align=\"center\" style=\"background-color: #ccccff\">");
                        }
                        out.println("<td>");
                        out.println("<input type=\"checkbox\" id=\"" + NewAlbum.getAlbum_id() + "\" name=\"" + NewAlbum.getAlbum_id() + "\" value=\"" + NewAlbum.getAlbum_id() + "\" onclick=\"check('" + NewAlbum.getAlbum_id() + "')\"/>");
                        out.println("</td>");
                        out.println("<td><img src=\"" + NewAlbum.getAlbum_id() + ".jpg\" width=\"120\" height=\"120\"/></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getTitle() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getArtist() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getGenre() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getPublisher() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getYear() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewAlbum.getAlbum_id() + "\" type=\"submit\">" + NewAlbum.getPrice() + "</a></td>");
                        out.println("</tr>");
                    }
                }
            }
            //songs
            if (GetChoice == 2 && "".equals(KeyWords)) {
                NodeList Nodes = Xml_Op.ReadXml("Songs.xml", "song");
                out.println("<tr align=\"center\" style=\"background-color: #a9a9a9\"><td></td><td style=\"width: 120px\">Title</td><td style=\"width: 80px\">Artist</td><td style=\"width: 150px\">Album</td><td style=\"width: 80px\">Genre</td><td style=\"width: 50px\">Year</td><td style=\"width: 50px\">Price</td></tr>");
                int len = Nodes.getLength();
                for (int i = 0; i < len; i++) {
                    Node nNode = Nodes.item(i);
                    song NewSong = new song();
                    String temp;
                    Element eElement = (Element) nNode;
                    temp = eElement.getElementsByTagName("song_name").item(0).getChildNodes().item(0).getNodeValue();
                    NewSong.setSong_name(temp);
                    temp = eElement.getElementsByTagName("song_id").item(0).getChildNodes().item(0).getNodeValue();
                    NewSong.setSong_id(temp);
                    temp = eElement.getElementsByTagName("in_album").item(0).getChildNodes().item(0).getNodeValue();
                    NewSong.setIn_album(temp);
                    temp = eElement.getElementsByTagName("Price").item(0).getChildNodes().item(0).getNodeValue();
                    NewSong.setPrice(temp);
                    temp = eElement.getElementsByTagName("Artist").item(0).getChildNodes().item(0).getNodeValue();
                    NewSong.setArtist(temp);

                    NodeList aim_al = Xml_Op.ReadXml("Albums.xml", "album");
                    Search S_al = new Search();
                    album al = S_al.SearchAlbum(NewSong.getIn_album(), aim_al);
                    NewSong.setGenre(al.getGenre());
                    NewSong.setYear(al.getYear());
                    NewSong.setAlbum(al.getTitle());
                    NewSong.setPublisher(al.getPublisher());
                    if (!"".equals(sGenre)) {
                        if (!al.getGenre().equals(sGenre)) {
                            continue;
                        }
                    }
                    if (!"".equals(sYear)) {
                        if (!al.getYear().equals(sYear)) {
                            continue;
                        }
                    }
                    if (!"".equals(sArtist)) {
                        if (NewSong.getArtist().indexOf(sArtist) == -1) {
                            continue;
                        }
                    }
//                    out.println("<input type=\"checkbox\" id=\"" + NewSong.getSong_id() + "\" name=\"" + NewSong.getSong_id() + "\" value=\"" + NewSong.getSong_id() + "\" onclick=\"check('" + NewSong.getSong_id() + "')\"/>");
//                    out.println(NewSong.getSong_id() + "---" + NewSong.getSong_name() + "---" + NewSong.getIn_album() + "---" + NewSong.getArtist() + "---" + NewSong.getPrice() + "---" + NewSong.getGenre() + "---" + NewSong.getYear() + "---" + NewSong.getAlbum() + "---" + NewSong.getPublisher() + "</br>");
                    //                    <tr align=\"center\" style=\"background-color: #a9a9a9\"><td></td><td style=\"width: 80px\>Song No.</td><td style=\"width: 120px\>Title</td><td style=\"width: 80px\>Artist</td><td style=\"width: 150px\>Album</td><td style=\"width: 80px\>Genre</td><td style=\"width: 50px\>Year</td><td style=\"width: 50px\>Price</td></tr>
                    if (i % 2 == 1) {
                        out.println("<tr align=\"center\" style=\"background-color: #99ccff\">");
                    } else {
                        out.println("<tr align=\"center\" style=\"background-color: #ccccff\">");
                    }
                    out.println("<td>");
                    out.println("<input type=\"checkbox\" id=\"" + NewSong.getSong_id() + "\" name=\"" + NewSong.getSong_id() + "\" value=\"" + NewSong.getSong_id() + "\" onclick=\"check('" + NewSong.getSong_id() + "')\"/>");
                    out.println("</td>");

                    out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getSong_name() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getArtist() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getAlbum() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getGenre() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getYear() + "</a></td>");
                    out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getPrice() + "</a></td>");
                    out.println("</tr>");

                }
            }
            if (GetChoice == 2 && !"".equals(KeyWords)) {
                NodeList Nodes = Xml_Op.ReadXml("Songs.xml", "song");
                out.println("<tr align=\"center\" style=\"background-color: #a9a9a9\"><td></td><td style=\"width: 120px\">Title</td><td style=\"width: 80px\">Artist</td><td style=\"width: 150px\">Album</td><td style=\"width: 80px\">Genre</td><td style=\"width: 50px\">Year</td><td style=\"width: 50px\">Price</td></tr>");
                int len = Nodes.getLength();
                for (int i = 0; i < len; i++) {
                    Node nNode = Nodes.item(i);
                    song NewSong = new song();
                    String temp;
                    Element eElement = (Element) nNode;
                    temp = eElement.getElementsByTagName("song_name").item(0).getChildNodes().item(0).getNodeValue();
                    if (temp.indexOf(KeyWords) != -1) {
                        NewSong.setSong_name(temp);
                        temp = eElement.getElementsByTagName("song_id").item(0).getChildNodes().item(0).getNodeValue();
                        NewSong.setSong_id(temp);
                        temp = eElement.getElementsByTagName("in_album").item(0).getChildNodes().item(0).getNodeValue();
                        NewSong.setIn_album(temp);
                        temp = eElement.getElementsByTagName("Price").item(0).getChildNodes().item(0).getNodeValue();
                        NewSong.setPrice(temp);
                        temp = eElement.getElementsByTagName("Artist").item(0).getChildNodes().item(0).getNodeValue();
                        NewSong.setArtist(temp);
                        NodeList aim_al = Xml_Op.ReadXml("Albums.xml", "album");
                        Search S_al = new Search();
                        album al = S_al.SearchAlbum(NewSong.getIn_album(), aim_al);
                        NewSong.setGenre(al.getGenre());
                        NewSong.setYear(al.getYear());
                        NewSong.setAlbum(al.getTitle());
                        NewSong.setPublisher(al.getPublisher());

                        if (!"".equals(sGenre)) {
                            if (!al.getGenre().equals(sGenre)) {
                                continue;
                            }
                        }
                        if (!"".equals(sYear)) {
                            if (!al.getYear().equals(sYear)) {
                                continue;
                            }
                        }
                        if (!"".equals(sArtist)) {
                            if (NewSong.getArtist().indexOf(sArtist) == -1) {
                                continue;
                            }
                        }
                        if (i % 2 == 1) {
                            out.println("<tr align=\"center\" style=\"background-color: #99ccff\">");
                        } else {
                            out.println("<tr align=\"center\" style=\"background-color: #ccccff\">");
                        }
                        out.println("<td>");
                        out.println("<input type=\"checkbox\" id=\"" + NewSong.getSong_id() + "\" name=\"" + NewSong.getSong_id() + "\" value=\"" + NewSong.getSong_id() + "\" onclick=\"check('" + NewSong.getSong_id() + "')\"/>");
                        out.println("</td>");

                        out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getSong_name() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getArtist() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getAlbum() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getGenre() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getYear() + "</a></td>");
                        out.println("<td><a href =\"Al_Details?id=" + NewSong.getIn_album() + "\" type=\"submit\">" + NewSong.getPrice() + "</a></td>");
                        out.println("</tr>");

                    }
                }
            }

            out.println("</table>");
            out.println("</td>");
            out.println("</tr>");
            out.println("</table>");
            out.println("</body>");
            out.println("</html>");
        } finally {
            out.close();
        }

        processRequest(request, response);
    }

    /**
     * Returns a short description of the servlet.
     *
     * @return a String containing servlet description
     */
    @Override
    public String getServletInfo() {
        return "Short description";
    }// </editor-fold>
}
